devtools::install_github("mattflor/chorddiag")
library(chorddiag)

## example taken from the github site
m <- matrix(c(0.001, 0.002, 0.001, 0.001, 0, 0, 0, 0.001, 0, 0.001, 0, 0, 0, 0, 0.001, 0.001, 0.001, 0.001, 0.001, 0, 0, 0, 0.001, 0, 0, 0, 0, 0, 0, 0, 0,
              0.001, 0.001, 0.001, 0.001, 0, 0, 0, 0.001, 0, 0.001, 0, 0, 0, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0, 0, 0, 0.001, 0, 0, 0, 0, 0, 0, 0, 0,
              0.004, 0.004, 0.004, 0.005, 0, 0, 0.001, 0.002, 0.001, 0.004, 0.002, 0.001, 0.002, 0.003, 0.005, 0.003, 0.005, 0.002, 0.003, 0, 0, 0, 0.003, 0, 0, 0, 0, 0.001, 0, 0, 0,
              0.001, 0.001, 0.002, 0.002, 0, 0, 0, 0.001, 0, 0.001, 0.001, 0, 0, 0.001, 0.001, 0.001, 0.002, 0.001, 0.001, 0, 0, 0, 0.001, 0, 0, 0, 0, 0, 0, 0, 0,
              0.001, 0.001, 0.001, 0.001, 0, 0, 0, 0.001, 0, 0.001, 0.001, 0, 0, 0.001, 0.001, 0.001, 0.001, 0.001, 0, 0, 0, 0, 0.001, 0, 0, 0, 0, 0, 0, 0, 0,
              0.001, 0.001, 0.001, 0.001, 0, 0, 0.002, 0.003, 0.001, 0.002, 0.001, 0.001, 0, 0.002, 0.002, 0.001, 0.003, 0.002, 0.001, 0, 0, 0, 0.002, 0, 0, 0, 0, 0, 0, 0, 0,
              0.001, 0.001, 0.001, 0.001, 0, 0, 0.001, 0.002, 0, 0.001, 0, 0, 0, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0, 0, 0, 0.001, 0, 0, 0, 0, 0, 0, 0, 0,
              0.001, 0.001, 0.001, 0.001, 0, 0, 0.001, 0.004, 0, 0.001, 0.001, 0, 0, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0, 0, 0, 0.001, 0, 0, 0, 0, 0, 0, 0, 0,
              0.001, 0.001, 0.001, 0.001, 0, 0, 0, 0.001, 0.001, 0.005, 0.002, 0.002, 0.001, 0.002, 0.002, 0.001, 0.002, 0.001, 0.002, 0, 0, 0, 0.001, 0, 0, 0, 0, 0, 0, 0, 0,
              0.002, 0.002, 0.002, 0.002, 0, 0, 0.001, 0.002, 0.003, 0.013, 0.007, 0.004, 0.001, 0.005, 0.006, 0.003, 0.006, 0.004, 0.005, 0.001, 0, 0, 0.003, 0, 0, 0, 0.001, 0.001, 0, 0, 0.001,
              0.001, 0.002, 0.001, 0.002, 0, 0, 0.001, 0.002, 0.003, 0.009, 0.005, 0.003, 0.001, 0.003, 0.003, 0.002, 0.004, 0.003, 0.003, 0, 0, 0, 0.002, 0, 0, 0, 0, 0, 0, 0, 0,
              0.001, 0.002, 0.001, 0.001, 0, 0, 0.001, 0.001, 0.002, 0.008, 0.004, 0.003, 0.001, 0.004, 0.004, 0.002, 0.005, 0.004, 0.002, 0, 0, 0, 0.002, 0, 0, 0, 0, 0, 0, 0, 0,
              0.001, 0.001, 0.001, 0.001, 0, 0, 0, 0.001, 0.001, 0.003, 0.003, 0.001, 0.002, 0.003, 0.002, 0.002, 0.006, 0.004, 0.004, 0, 0, 0.001, 0.003, 0, 0, 0, 0, 0, 0, 0, 0,
              0.001, 0.001, 0.001, 0.001, 0, 0, 0, 0.001, 0.001, 0.003, 0.002, 0.001, 0.001, 0.005, 0.002, 0.001, 0.004, 0.003, 0.003, 0, 0, 0, 0.002, 0, 0, 0, 0, 0, 0, 0, 0,
              0.004, 0.006, 0.004, 0.003, 0, 0, 0.001, 0.003, 0.003, 0.008, 0.003, 0.002, 0.001, 0.005, 0.012, 0.005, 0.007, 0.005, 0.005, 0, 0, 0, 0.004, 0, 0, 0, 0.001, 0.001, 0, 0, 0.001,
              0.002, 0.002, 0.002, 0.004, 0, 0, 0.001, 0.002, 0.002, 0.006, 0.003, 0.002, 0.002, 0.006, 0.006, 0.013, 0.011, 0.005, 0.006, 0.001, 0, 0.001, 0.005, 0, 0, 0, 0.001, 0.001, 0, 0, 0.001,
              0.001, 0.001, 0.002, 0.001, 0, 0, 0.001, 0.001, 0.001, 0.003, 0.001, 0.001, 0.001, 0.005, 0.002, 0.003, 0.010, 0.004, 0.004, 0, 0, 0.001, 0.003, 0, 0, 0, 0, 0, 0, 0, 0,
              0.002, 0.001, 0.001, 0.001, 0, 0, 0.001, 0.002, 0.001, 0.003, 0.002, 0.001, 0.001, 0.005, 0.002, 0.003, 0.008, 0.006, 0.004, 0, 0, 0.001, 0.003, 0, 0, 0, 0, 0, 0, 0, 0,
              0.002, 0.003, 0.002, 0.002, 0, 0, 0.001, 0.002, 0.002, 0.005, 0.003, 0.001, 0.002, 0.006, 0.004, 0.003, 0.008, 0.004, 0.014, 0.001, 0, 0.001, 0.006, 0, 0, 0, 0, 0.001, 0, 0, 0.001,
              0.001, 0.001, 0, 0.001, 0, 0, 0, 0.001, 0, 0.002, 0.001, 0.001, 0.001, 0.002, 0.001, 0.001, 0.002, 0.002, 0.003, 0.001, 0, 0, 0.002, 0, 0, 0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.001, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
              0, 0.001, 0.001, 0.001, 0, 0, 0, 0.001, 0.001, 0.002, 0.001, 0.001, 0, 0.002, 0.001, 0.001, 0.003, 0.002, 0.002, 0, 0, 0.001, 0.007, 0, 0, 0, 0, 0, 0, 0, 0,
              0.001, 0.001, 0.001, 0.002, 0, 0, 0.001, 0.001, 0.001, 0.004, 0.002, 0.001, 0.002, 0.004, 0.003, 0.003, 0.006, 0.003, 0.004, 0, 0, 0.003, 0.021, 0, 0, 0, 0.001, 0.001, 0, 0, 0.001,
              0, 0, 0, 0.001, 0, 0, 0, 0, 0, 0.001, 0, 0, 0, 0.001, 0.001, 0.001, 0.002, 0.001, 0.001, 0, 0, 0.001, 0.003, 0, 0, 0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0, 0, 0, 0, 0.001, 0, 0, 0, 0.001, 0.001, 0, 0.001, 0.001, 0.001, 0, 0, 0, 0.002, 0, 0, 0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
              0, 0.001, 0.001, 0.001, 0, 0, 0, 0.001, 0, 0.002, 0.001, 0, 0, 0.002, 0.001, 0.002, 0.003, 0.002, 0.002, 0, 0, 0, 0.002, 0, 0, 0, 0.001, 0.001, 0, 0, 0,
              0, 0, 0, 0, 0, 0, 0, 0, 0, 0.001, 0, 0, 0, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0, 0, 0, 0.002, 0, 0, 0, 0, 0.001, 0, 0, 0,
              0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.002),
            byrow = TRUE,
            nrow = 31, ncol = 31)
haircolors <- c("Beijing", "Tianjin", "Hebei", "Shanxi", "Inner Mongolia", "Liaoning",	"Jilin",	"Heilongjiang",	"Shanghai",	"Jiangsu",	"Zhejiang",	"Anhui",	"Fujian",	"Jiangxi",	"Shandong",	"Henan",	"Hubei",	"Hunan",	"Guangdong",	"Guangxi",	"Hainan",	"Chongqing",	"Sichuan",	"Guizhou",	"Yunnan",	"Xizang",	"Shaanxi",	"Gansu",	"Qinghai",	"Ningxia",	"Xinjiang")
dimnames(m) <- list(have = haircolors,
                    prefer = haircolors)
m
#        prefer
#   have Beijing	Tianjin	Hebei	Shanxi	Inner Mongolia	Liaoning	Jilin	Heilongjiang	Shanghai	Jiangsu	Zhejiang	Anhui	Fujian	Jiangxi	Shandong	Henan	Hubei	Hunan	Guangdong	Guangxi	Hainan	Chongqing	Sichuan	Guizhou	Yunnan	Xizang	Shaanxi	Gansu	Qinghai	Ningxia	Xinjiang
#   Beijing	0.001	0.002	0.001	0.001	0	0	0	0.001	0	0.001	0	0	0	0	0.001	0.001	0.001	0.001	0.001	0	0	0	0.001	0	0	0	0	0	0	0	0
#   Tianjin	0.001	0.001	0.001	0.001	0	0	0	0.001	0	0.001	0	0	0	0.001	0.001	0.001	0.001	0.001	0.001	0	0	0	0.001	0	0	0	0	0	0	0	0
#   Hebei	0.004	0.004	0.004	0.005	0	0	0.001	0.002	0.001	0.004	0.002	0.001	0.002	0.003	0.005	0.003	0.005	0.002	0.003	0	0	0	0.003	0	0	0	0	0.001	0	0	0
#   Shanxi	0.001	0.001	0.002	0.002	0	0	0	0.001	0	0.001	0.001	0	0	0.001	0.001	0.001	0.002	0.001	0.001	0	0	0	0.001	0	0	0	0	0	0	0	0
#   Inner Mongolia	0.001	0.001	0.001	0.001	0	0	0	0.001	0	0.001	0.001	0	0	0.001	0.001	0.001	0.001	0.001	0	0	0	0	0.001	0	0	0	0	0	0	0	0
#   Liaoning	0.001	0.001	0.001	0.001	0	0	0.002	0.003	0.001	0.002	0.001	0.001	0	0.002	0.002	0.001	0.003	0.002	0.001	0	0	0	0.002	0	0	0	0	0	0	0	0
#   Jilin	0.001	0.001	0.001	0.001	0	0	0.001	0.002	0	0.001	0	0	0	0.001	0.001	0.001	0.001	0.001	0.001	0	0	0	0.001	0	0	0	0	0	0	0	0
#   Heilongjiang	0.001	0.001	0.001	0.001	0	0	0.001	0.004	0	0.001	0.001	0	0	0.001	0.001	0.001	0.001	0.001	0.001	0	0	0	0.001	0	0	0	0	0	0	0	0
#   Shanghai	0.001	0.001	0.001	0.001	0	0	0	0.001	0.001	0.005	0.002	0.002	0.001	0.002	0.002	0.001	0.002	0.001	0.002	0	0	0	0.001	0	0	0	0	0	0	0	0
#   Jiangsu	0.002	0.002	0.002	0.002	0	0	0.001	0.002	0.003	0.013	0.007	0.004	0.001	0.005	0.006	0.003	0.006	0.004	0.005	0.001	0	0	0.003	0	0	0	0.001	0.001	0	0	0.001
#   Zhejiang	0.001	0.002	0.001	0.002	0	0	0.001	0.002	0.003	0.009	0.005	0.003	0.001	0.003	0.003	0.002	0.004	0.003	0.003	0	0	0	0.002	0	0	0	0	0	0	0	0
#   Anhui	0.001	0.002	0.001	0.001	0	0	0.001	0.001	0.002	0.008	0.004	0.003	0.001	0.004	0.004	0.002	0.005	0.004	0.002	0	0	0	0.002	0	0	0	0	0	0	0	0
#   Fujian	0.001	0.001	0.001	0.001	0	0	0	0.001	0.001	0.003	0.003	0.001	0.002	0.003	0.002	0.002	0.006	0.004	0.004	0	0	0.001	0.003	0	0	0	0	0	0	0	0
#   Jiangxi	0.001	0.001	0.001	0.001	0	0	0	0.001	0.001	0.003	0.002	0.001	0.001	0.005	0.002	0.001	0.004	0.003	0.003	0	0	0	0.002	0	0	0	0	0	0	0	0
#   Shandong	0.004	0.006	0.004	0.003	0	0	0.001	0.003	0.003	0.008	0.003	0.002	0.001	0.005	0.012	0.005	0.007	0.005	0.005	0	0	0	0.004	0	0	0	0.001	0.001	0	0	0.001
#   Henan	0.002	0.002	0.002	0.004	0	0	0.001	0.002	0.002	0.006	0.003	0.002	0.002	0.006	0.006	0.013	0.011	0.005	0.006	0.001	0	0.001	0.005	0	0	0	0.001	0.001	0	0	0.001
#   Hubei	0.001	0.001	0.002	0.001	0	0	0.001	0.001	0.001	0.003	0.001	0.001	0.001	0.005	0.002	0.003	0.010	0.004	0.004	0	0	0.001	0.003	0	0	0	0	0	0	0	0
#   Hunan	0.002	0.001	0.001	0.001	0	0	0.001	0.002	0.001	0.003	0.002	0.001	0.001	0.005	0.002	0.003	0.008	0.006	0.004	0	0	0.001	0.003	0	0	0	0	0	0	0	0
#   Guangdong	0.002	0.003	0.002	0.002	0	0	0.001	0.002	0.002	0.005	0.003	0.001	0.002	0.006	0.004	0.003	0.008	0.004	0.014	0.001	0	0.001	0.006	0	0	0	0	0.001	0	0	0.001
#   Guangxi	0.001	0.001	0	0.001	0	0	0	0.001	0	0.002	0.001	0.001	0.001	0.002	0.001	0.001	0.002	0.002	0.003	0.001	0	0	0.002	0	0	0	0	0	0	0	0
#   Hainan	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0.001	0	0	0	0	0	0	0	0	0	0	0	0
#   Chongqing	0	0.001	0.001	0.001	0	0	0	0.001	0.001	0.002	0.001	0.001	0	0.002	0.001	0.001	0.003	0.002	0.002	0	0	0.001	0.007	0	0	0	0	0	0	0	0
#   Sichuan	0.001	0.001	0.001	0.002	0	0	0.001	0.001	0.001	0.004	0.002	0.001	0.002	0.004	0.003	0.003	0.006	0.003	0.004	0	0	0.003	0.021	0	0	0	0.001	0.001	0	0	0.001
#   Guizhou	0	0	0	0.001	0	0	0	0	0	0.001	0	0	0	0.001	0.001	0.001	0.002	0.001	0.001	0	0	0.001	0.003	0	0	0	0	0	0	0	0
#   Yunnan	0	0	0	0	0	0	0	0	0	0.001	0	0	0	0.001	0.001	0	0.001	0.001	0.001	0	0	0	0.002	0	0	0	0	0	0	0	0
#   Xizang	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
#   Shaanxi	0	0.001	0.001	0.001	0	0	0	0.001	0	0.002	0.001	0	0	0.002	0.001	0.002	0.003	0.002	0.002	0	0	0	0.002	0	0	0	0.001	0.001	0	0	0
#   Gansu	0	0	0	0	0	0	0	0	0	0.001	0	0	0	0.001	0.001	0.001	0.001	0.001	0.001	0	0	0	0.002	0	0	0	0	0.001	0	0	0
#   Qinghai	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
#   Ningxia	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
#   Xinjiang	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0.002



groupColors <- c("#AE0000", "#FF5151", "#FF60AF", "#FF5809", "#FFA042", "#FFD308", "#F9F900", "#9AFF02", "#00EC00", "#4EFEB3", "#00FFFF", "#46A3FF", "#4A4AFF", "#B15BFF", "#E800E8", "#AE57A4", "#8080C0", "#5CADAD", "#A5A552", "#AD5A5A", "#ADADAD", "#3C3C3C", "#C4C400", "#D26900", "#FFAD86", "#CDCD9A", "#000000", "#FFDD89", "#957244", "#F26223", "#111111")
chorddiag(m, groupColors = groupColors, groupnamePadding = 40)
